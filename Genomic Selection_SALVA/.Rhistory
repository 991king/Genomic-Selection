"numeric", #BIOM/YIELD
"numeric", #Rust in %
"numeric", #Dtf
"numeric", #DtFP
"numeric", #DtP
"numeric", #Ascochyta in %
"numeric"  #Oidio in %
))
## Metan package allow to calculate BLUPs and others stability indexes and parameters. It also offers statistic help.
gen_alpha <-
gamem(R18, #data
GEN, #genotype
REP, #replicate
c("T_Rust", "Asco", "Oidio"), # diseases trait
block = BLOCK) #block
#plot(gen_alpha, type = "re")
get_model_data(gen_alpha)
##BLUP histogram for diseases in 2018 season:
par(mfrow = c(3,2))
hist(gen_alpha$T_Rust$BLUPgen$Predicted , main = "BLUP distribution of Rust %")
hist(R18$T_Rust,  main = "RawData distribution of Rust %")
hist(gen_alpha$Asco$BLUPgen$Predicted , main = "BLUP distribution of Ascochyta %")
hist(R18$Asco,  main = "RawData distribution of Ascochyta %")
hist(gen_alpha$Oidio$BLUPgen$Predicted , main = "BLUP distribution of Oidio %")
hist(R18$Oidio,  main = "RawData distribution of Oidio %")
library(metan)
library(readxl)
library(tidyverse)
library(ggstatsplot)
library(hrbrthemes)
R18 <- read_excel("~/GitHub/Genomic-Selection/Genomic Selection_SALVA/data/Ensayocampo2018.xlsx", sheet = "RawData", col_types =
c("text", #ENV
"numeric", #REP
"numeric", #BLOCK
"numeric", #ROW
"text", #GEN
"numeric", #GERM
"numeric", #BIOM
"numeric", #BIOM_PL
"numeric", #YIELD
"numeric", #YIELD_PL
"numeric", #BIOM/YIELD
"numeric", #Rust in %
"numeric", #Dtf
"numeric", #DtFP
"numeric", #DtP
"numeric", #Ascochyta in %
"numeric"  #Oidio in %
))
## Metan package allow to calculate BLUPs and others stability indexes and parameters. It also offers statistic help.
gen_alpha <-
gamem(R18, #data
GEN, #genotype
REP, #replicate
c("T_Rust", "Asco", "Oidio"), # diseases trait
block = BLOCK) #block
#plot(gen_alpha, type = "re")
get_model_data(gen_alpha)
##BLUP histogram for diseases in 2018 season:
par(mfrow = c(3,2))
hist(gen_alpha$T_Rust$BLUPgen$Predicted , main = "BLUP distribution of Rust %")
hist(R18$T_Rust,  main = "RawData distribution of Rust %")
hist(gen_alpha$Asco$BLUPgen$Predicted , main = "BLUP distribution of Ascochyta %")
hist(R18$Asco,  main = "RawData distribution of Ascochyta %")
hist(gen_alpha$Oidio$BLUPgen$Predicted , main = "BLUP distribution of Oidio %")
hist(R18$Oidio,  main = "RawData distribution of Oidio %")
library(metan)
library(readxl)
library(tidyverse)
library(ggstatsplot)
library(hrbrthemes)
R18 <- read_excel("~/GitHub/Genomic-Selection/Genomic Selection_SALVA/data/Ensayocampo2018.xlsx", sheet = "RawData", col_types =
c("text", #ENV
"numeric", #REP
"numeric", #BLOCK
"numeric", #ROW
"text", #GEN
"numeric", #GERM
"numeric", #BIOM
"numeric", #BIOM_PL
"numeric", #YIELD
"numeric", #YIELD_PL
"numeric", #BIOM/YIELD
"numeric", #Rust in %
"numeric", #Dtf
"numeric", #DtFP
"numeric", #DtP
"numeric", #Ascochyta in %
"numeric"  #Oidio in %
))
## Metan package allow to calculate BLUPs and others stability indexes and parameters. It also offers statistic help.
gen_alpha <-
gamem(R18, #data
GEN, #genotype
REP, #replicate
c("T_Rust", "Asco", "Oidio"), # diseases trait
block = BLOCK) #block
#plot(gen_alpha, type = "re")
get_model_data(gen_alpha)
##BLUP histogram for diseases in 2018 season:
par(mfrow = c(3,2))
hist(gen_alpha$T_Rust$BLUPgen$Predicted , main = "BLUP distribution of Rust %")
hist(R18$T_Rust,  main = "RawData distribution of Rust %")
hist(gen_alpha$Asco$BLUPgen$Predicted , main = "BLUP distribution of Ascochyta %")
hist(R18$Asco,  main = "RawData distribution of Ascochyta %")
hist(gen_alpha$Oidio$BLUPgen$Predicted , main = "BLUP distribution of Oidio %")
hist(R18$Oidio,  main = "RawData distribution of Oidio %")
R19 <- read_excel("~/GitHub/Genomic-Selection/Genomic Selection_SALVA/data/R18_19_20.xlsx",
sheet = "R19",
col_types =
c("text", #ENV
"numeric", #REP
"numeric", #BLOCK
"numeric", #ROW
"text", #GEN
"numeric", #GERM
"numeric", #GERMadj
"numeric", #DtFF
"numeric", #DtFFadj
"numeric", #GDD_FF
"numeric", #DtF
"numeric", #DtFadj
"numeric", #GDD_F
"numeric", #DtFP
"numeric", #DtFPadj
"numeric", #GDD_FP
"numeric", #DtP
"numeric", #DtPadj
"numeric", #GDD_P
"numeric", #DtM
"numeric", #DtMadj
"numeric", #GDD_M
"numeric", #rust
"numeric", #rustadj
"numeric", #biomass_pl
"numeric", #yield_pl
"numeric", #yield_KgHa
))
R19 <- read_excel("~/GitHub/Genomic-Selection/Genomic Selection_SALVA/data/R18_19_20.xlsx",
sheet = "R19",
col_types =
c("text", #ENV
"numeric", #REP
"numeric", #BLOCK
"numeric", #ROW
"text", #GEN
"numeric", #GERM
"numeric", #GERMadj
"numeric", #DtFF
"numeric", #DtFFadj
"numeric", #GDD_FF
"numeric", #DtF
"numeric", #DtFadj
"numeric", #GDD_F
"numeric", #DtFP
"numeric", #DtFPadj
"numeric", #GDD_FP
"numeric", #DtP
"numeric", #DtPadj
"numeric", #GDD_P
"numeric", #DtM
"numeric", #DtMadj
"numeric", #GDD_M
"numeric", #rust
"numeric", #rustadj
"numeric", #biomass_pl
"numeric", #yield_pl
"numeric" #yield_KgHa
))
R19 <- data.frame(R19)
as_factor(R19$ENV)
as_factor(R19$REP)
as_factor(R19$GEN)
#functions#
library("metan")
inspect(R19, plot = T)
desc_stat(R19)
gen_alpha1 <-
gamem(R19,
GEN,
REP,
Rust_adj,
block = BLOCK)
plot(gen_alpha)
plot(gen_alpha, type = "re")
get_model_data(gen_alpha1)
gen_alpha1 <-
gamem(R19,
GEN,
REP,
Rust_.,
block = BLOCK)
plot(gen_alpha)
plot(gen_alpha, type = "re")
get_model_data(gen_alpha1)
get_model_data(gen_alpha1, "lrt")
hist(mixed_mod$Rust_.$BLUPgen$BLUPg)
hist(gen_alpha1$Rust_.$BLUPgen$BLUPg)
hist(R19$Rust_.)
gen_alpha1 <-
gamem(R19,
GEN,
REP,
c(GDD_FF, GDD_F, GDD_FP, GDD_MP),
block = BLOCK)
plot(gen_alpha1)
plot(gen_alpha, type = "re")
get_model_data(gen_alpha1)
plot(gen_alpha1, type = "re")
get_model_data(gen_alpha1, "lrt")
R19 <- read_excel("~/GitHub/Genomic-Selection/Genomic Selection_SALVA/data/R18_19_20.xlsx",
sheet = "R19_nc",
col_types =
c("text", #ENV
"numeric", #REP
"numeric", #BLOCK
"numeric", #ROW
"text", #GEN
"numeric", #GERM
"numeric", #GERMadj
"numeric", #DtFF
"numeric", #DtFFadj
"numeric", #GDD_FF
"numeric", #DtF
"numeric", #DtFadj
"numeric", #GDD_F
"numeric", #DtFP
"numeric", #DtFPadj
"numeric", #GDD_FP
"numeric", #DtP
"numeric", #DtPadj
"numeric", #GDD_P
"numeric", #DtM
"numeric", #DtMadj
"numeric", #GDD_M
"numeric", #rust
"numeric", #rustadj
"numeric", #biomass_pl
"numeric", #yield_pl
"numeric" #yield_KgHa
))
R19 <- data.frame(R19)
as_factor(R19$ENV)
as_factor(R19$REP)
as_factor(R19$GEN)
gen_alpha1 <-
gamem(R19,
GEN,
REP,
c(Rust_., Rust_adj),
block = BLOCK)
plot(gen_alpha1)
plot(gen_alpha1, type = "re")
get_model_data(gen_alpha1)
get_model_data(gen_alpha1, "lrt")
hist(gen_alpha1$Rust_.$BLUPgen$BLUPg)
hist(R19$Rust_.)
R18_nc <- read_excel("~/GitHub/Genomic-Selection/Genomic Selection_SALVA/data/R18_19_20.xlsx",
sheet = "R18_nc",
col_types =
c("text", #ENV
"numeric", #REP
"numeric", #BLOCK
"numeric", #ROW
"text", #GEN
"numeric", #GERM
"numeric", #DtF
"numeric", #GDD_F
"numeric", #DtM
"numeric", #GDD_M
"numeric", #biomass_pl
"numeric", #yield_pl
"numeric", #yield_KgHa
"numeric", #Asco_adj
"numeric", #Roya_%
"numeric", #Roya_adj
"numeric", #Oidio_%
))
R18_nc <- read_excel("~/GitHub/Genomic-Selection/Genomic Selection_SALVA/data/R18_19_20.xlsx",
sheet = "R18_nc",
col_types =
c("text", #ENV
"numeric", #REP
"numeric", #BLOCK
"numeric", #ROW
"text", #GEN
"numeric", #GERM
"numeric", #DtF
"numeric", #GDD_F
"numeric", #DtM
"numeric", #GDD_M
"numeric", #biomass_pl
"numeric", #yield_pl
"numeric", #yield_KgHa
"numeric", #Asco_adj
"numeric", #Roya_%
"numeric", #Roya_adj
"numeric" #Oidio_%
))
R19_nc <- read_excel("~/GitHub/Genomic-Selection/Genomic Selection_SALVA/data/R18_19_20.xlsx",
sheet = "R19_nc",
col_types =
c("text", #ENV
"numeric", #REP
"numeric", #BLOCK
"numeric", #ROW
"text", #GEN
"numeric", #GERM
"numeric", #GERMadj
"numeric", #DtFF
"numeric", #DtFFadj
"numeric", #GDD_FF
"numeric", #DtF
"numeric", #DtFadj
"numeric", #GDD_F
"numeric", #DtFP
"numeric", #DtFPadj
"numeric", #GDD_FP
"numeric", #DtP
"numeric", #DtPadj
"numeric", #GDD_P
"numeric", #DtM
"numeric", #DtMadj
"numeric", #GDD_M
"numeric", #rust
"numeric", #rustadj
"numeric", #biomass_pl
"numeric", #yield_pl
"numeric" #yield_KgHa
))
R20 <- read_excel("~/GitHub/Genomic-Selection/Genomic Selection_SALVA/data/R18_19_20.xlsx",
sheet = "R20",
col_types =
c("text", #ENV
"numeric", #REP
"numeric", #BLOCK
"numeric", #ROW
"text", #GEN
"numeric", #GERM
"numeric", #DtFF
"numeric", #GDD_FF
"numeric", #DtF
"numeric", #GDD_F
"numeric", #DtFP
"numeric", #GDD_FP
"numeric", #DtP
"numeric", #GDD_P
"numeric", #DtM
"numeric", #GDD_M
"numeric", #rustadj
"numeric", #asco_%
"numeric", #asco_adj
"numeric", #oidio_%
"numeric" #Oidio_adj
))
gen_alpha18 <-
gamem(R18_nc,
GEN,
REP,
c(Rust_adj),
block = BLOCK)
gen_alpha19 <-
gamem(R19_nc,
GEN,
REP,
c(Rust_adj),
block = BLOCK)
gen_alpha19 <-
gamem(R19_nc,
GEN,
REP,
c(Rust_%, Rust_adj),
block = BLOCK)
gen_alpha19 <-
gamem(R19_nc,
GEN,
REP,
c(Rust_., Rust_adj),
block = BLOCK)
R19_nc <- read_excel("~/GitHub/Genomic-Selection/Genomic Selection_SALVA/data/R18_19_20.xlsx",
sheet = "R19_nc",
col_types =
c("text", #ENV
"numeric", #REP
"numeric", #BLOCK
"numeric", #ROW
"text", #GEN
"numeric", #GERM
"numeric", #GERMadj
"numeric", #DtFF
"numeric", #DtFFadj
"numeric", #GDD_FF
"numeric", #DtF
"numeric", #DtFadj
"numeric", #GDD_F
"numeric", #DtFP
"numeric", #DtFPadj
"numeric", #GDD_FP
"numeric", #DtP
"numeric", #DtPadj
"numeric", #GDD_P
"numeric", #DtM
"numeric", #DtMadj
"numeric", #GDD_M
"numeric", #rust
"numeric", #rustadj
"numeric", #biomass_pl
"numeric", #yield_pl
"numeric" #yield_KgHa
))
gen_alpha19 <-
gamem(R19_nc,
GEN,
REP,
c(Rust_., Rust_adj),
block = BLOCK)
gen_alpha20 <-
gamem(R20,
GEN,
REP,
c(Roya_adj),
block = BLOCK)
get_model_data(gen_alpha18)
get_model_data(gen_alpha19)
get_model_data(gen_alpha20)
hist(gen_alpha18$Rust_adj$BLUPgen$Predicted)
hist(gen_alpha19$Rust_.$BLUPgen$Predicted)
hist(gen_alpha20$Roya_adj$BLUPgen$Predicted)
get_model_data(gen_alpha18)
get_model_data(gen_alpha18)
get_model_data(gen_alpha18, "lrt")
get_model_data(gen_alpha19)
get_model_data(gen_alpha19, "lrt")
get_model_data(gen_alpha20)
get_model_data(gen_alpha20, "lrt")
get_model_data(gen_alpha18)
Rall <- read_excel("~/GitHub/Genomic-Selection/Genomic Selection_SALVA/data/R18_19_20.xlsx",
sheet = "R_all",
col_types =
c("text", #ENV
"numeric", #REP
"numeric", #BLOCK
"numeric", #ROW
"text", #GEN
"numeric", #GERM
"numeric", #DtF
"numeric", #GDD_F
"numeric", #DtP
"numeric", #GDD_P
"numeric", #Biom_pl
"numeric", #yield_pl
"numeric", #rustadj
"numeric", #asco_adj
"numeric", #Oidio_adj
))
Rall <- read_excel("~/GitHub/Genomic-Selection/Genomic Selection_SALVA/data/R18_19_20.xlsx",
sheet = "R_all",
col_types =
c("text", #ENV
"numeric", #REP
"numeric", #BLOCK
"numeric", #ROW
"text", #GEN
"numeric", #GERM
"numeric", #DtF
"numeric", #GDD_F
"numeric", #DtP
"numeric", #GDD_P
"numeric", #Biom_pl
"numeric", #yield_pl
"numeric", #rustadj
"numeric", #asco_adj
"numeric" #Oidio_adj
))
mixed_mod_all <- gamem_met(Rall,
env = ENV,
gen = GEN,
rep = REP,
resp = c(GDD_F, GDD_P, Biom_plant_g, yield_plant_g, Rust),
block = BLOCK,
random = "gen", #Default
verbose = TRUE) #Default
Rall <- read_excel("~/GitHub/Genomic-Selection/Genomic Selection_SALVA/data/R18_19_20.xlsx",
sheet = "R_all",
col_types =
c("text", #ENV
"numeric", #REP
"numeric", #BLOCK
"numeric", #ROW
"text", #GEN
"numeric", #GERM
"numeric", #DtF
"numeric", #GDD_F
"numeric", #DtP
"numeric", #GDD_P
"numeric", #Biom_pl
"numeric", #yield_pl
"numeric", #rustadj
"numeric", #asco_adj
"numeric" #Oidio_adj
))
mixed_mod_all <- gamem_met(Rall,
env = ENV,
gen = GEN,
rep = REP,
resp = c(GDD_F, GDD_P, Biom_plant_g, yield_plant_g, Rust),
block = BLOCK,
random = "gen", #Default
verbose = TRUE) #Default
get_model_data(mixed_mod_all)
get_model_data(mixed_mod_all, "lrt")
plot(mixed_mod_all)
