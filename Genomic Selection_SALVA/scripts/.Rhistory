# Q&A Alpha Lattice Design
library(agricolae)
data <-read.table(header = TRUE, text = "
Treatment	Replication	Block	Yield
1	1	1	6
2	1	1	7
3	1	1	5
4	1	1	8
5	1	1	6
6	1	2	16
7	1	2	12
8	1	2	12
9	1	2	13
10	1	2	8
11	1	3	17
12	1	3	7
13	1	3	7
14	1	3	9
15	1	3	14
16	1	4	18
17	1	4	16
18	1	4	13
19	1	4	13
20	1	4	14
21	1	5	14
22	1	5	15
23	1	5	11
24	1	5	14
25	1	5	14
1	2	1	24
6	2	1	13
11	2	1	24
16	2	1	11
21	2	1	8
2	2	2	21
7	2	2	11
12	2	2	14
17	2	2	11
22	2	2	23
3	2	3	16
8	2	3	4
13	2	3	12
18	2	3	12
23	2	3	12
4	2	4	17
9	2	4	10
14	2	4	30
19	2	4	9
24	2	4	23
5	2	5	15
10	2	5	15
15	2	5	22
20	2	5	16
25	2	5	19
")
View(data)
data$Treatment=as.factor(data$Treatment)
data$Replication=as.factor(data$Replication)
data$Block=as.factor(data$Block)
str(data)
## 1st way
model<-aov(Yield~Replication+Treatment+Replication:Block, data=data)
summary(model)
out<-HSD.test(Yield, Treatment, DFerror = 16, MSerror = 13.66, alpha = 0.05,console=TRUE)
out<-HSD.test(data$Yield, Treatment, DFerror = 16, MSerror = 13.66, alpha = 0.05,console=TRUE)
out<-HSD.test(data$Yield, data$Treatment, DFerror = 16, MSerror = 13.66, alpha = 0.05,console=TRUE)
## 2nd way
modelLattice<-PBIB.test(Block,Treatment,Replication,Yield,k=5,console = TRUE,
method =c("VC"),test = "tukey",alpha = 0.05,group = TRUE)
## 2nd way
modelLattice<-PBIB.test(data$Block,data$Treatment,data$Replication,data$Yield,k=5,console = TRUE,
method =c("VC"),test = "tukey",alpha = 0.05,group = TRUE)
## 2nd way
modelLattice<-PBIB.test(data,Block,Treatment,Replication,Yield,k=5,console = TRUE,
method =c("VC"),test = "tukey",alpha = 0.05,group = TRUE)
## 2nd way
modelLattice<-PBIB.test(Block,Treatment,Replication,Yield,k=5,console = TRUE,
method =c("VC"),test = "tukey",alpha = 0.05,group = TRUE)
## 2nd way
modelLattice<-PBIB.test(data$Block,Treatment,Replication,Yield,k=5,console = TRUE,
method =c("VC"),test = "tukey",alpha = 0.05,group = TRUE)
## 2nd way
modelLattice<-PBIB.test(data$Block,data$Treatment,Replication,Yield,k=5,console = TRUE,
method =c("VC"),test = "tukey",alpha = 0.05,group = TRUE)
## 2nd way
modelLattice<-PBIB.test(data$Block,data$Treatment,data$Replication,Yield,k=5,console = TRUE,
method =c("VC"),test = "tukey",alpha = 0.05,group = TRUE)
## 2nd way
modelLattice<-PBIB.test(data$Block,data$Treatment,data$Replication,data$Yield,k=5,console = TRUE,
method =c("VC"),test = "tukey",alpha = 0.05,group = TRUE)
#Example one
trt<-1:324
t <- length(trt)
# size block k
k<-19
# Blocks s
s<-t/k
s
#Example one
trt<-1:324
# size block k
k<-18
# Blocks s
s<-t/k
s
# replications r
r <- 3
outdesign<- design.alpha(trt,k,r,serie=2)
book<-outdesign$book
outdesign<- design.alpha(trt,k,r,serie=2)
#Example one
trt<-1:30
t <- length(trt)
# size block k
k<-3
# Blocks s
s<-t/k
# replications r
r <- 2
outdesign<- design.alpha(trt,k,r,serie=2)
#Example one
trt<-1:324
t <- length(trt)
# size block k
k<-19
# Blocks s
s<-t/k
# replications r
r <- 3
outdesign<- design.alpha(trt,k,r,serie=2)
celsius_to_kelvin <- function(temp_C) {
temp_K <- temp_C + 273.15
return(temp_K)
}
View(celsius_to_kelvin)
View(celsius_to_kelvin)
Rall <- data.frame(read.xlsx("R18_19_20.xlsx", sheet = "Rall", rowNames = T))
library(openxlsx)
Rall <- data.frame(read.xlsx("R18_19_20.xlsx", sheet = "Rall", rowNames = T))
Rall <- data.frame(read.xlsx("data/R18_19_20.xlsx", sheet = "Rall", rowNames = T))
Rall <- data.frame(read.xlsx("C:\Users\Salva\Desktop\DOCTORADO NUBE\ENSAYOS\GS\Genomic Selection_SALVA\data\R18_19_20.xlsx", sheet = "Rall", rowNames = T))
Rall <- data.frame(read.xlsx("C:/Users/Salva/Desktop/DOCTORADO NUBE/ENSAYOS/GS/Genomic Selection_SALVA/data/R18_19_20.xlsx", sheet = "Rall", rowNames = T))
Rall <- data.frame(read.xlsx("C:/Users/Salva/Desktop/DOCTORADO NUBE/ENSAYOS/GS/Genomic Selection_SALVA/data/R18_19_20.xlsx", sheet = "R_all", rowNames = T))
Rall <- data.frame(read.xlsx("C:/Users/Salva/Desktop/DOCTORADO NUBE/ENSAYOS/GS/Genomic Selection_SALVA/data/R18_19_20.xlsx", sheet = "R_all", rowNames = T))
install.packages("metan"
)
library("metan")
inspect(Rall, plot = TRUE)
as.factor(Rall$ENV)
inspect(Rall, plot = TRUE)
as.factor(Rall$ENV)
library(readxl)
R18_19_20 <- read_excel("C:/Users/Salva/Desktop/DOCTORADO NUBE/ENSAYOS/GS/Genomic Selection_SALVA/data/R18_19_20.xlsx",
sheet = "R_all", col_types = c("text",
"text", "text", "text", "text", "text",
"numeric", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric"))
View(R18_19_20)
Rall <- data.frame(R18_19_20))
Rall <- data.frame(R18_19_20)
Rall
inspect(Rall, plot = F)
inspect(Rall, plot = T)
as_factor(Rall$ENV)
as_factor(Rall$ENV)
as_factor(Rall$REP)
as_factor(Rall$BLOCK)
as_factor(Rall$GEN)
Rall <- data.frame(R18_19_20)
inspect(Rall, plot = T)
Rall <- data.frame(R18_19_20)
as_factor(Rall$ENV)
as_factor(Rall$REP)
as_factor(Rall$BLOCK)
as_factor(Rall$GEN)
inspect(Rall, plot = T)
desc_stat(Rall)
mixed_mod <-
gamem_met(Rall,
env = ENV,
gen = GEN,
rep = REP,
resp = "Rust_adj",
random = "gen", #Default
verbose = TRUE)
mixed_mod <-
gamem_met(Rall,
env = ENV,
gen = GEN,
rep = REP,
block = BLOCK,
resp = "Rust_adj",
random = "gen", #Default
verbose = TRUE)
plot(mixed_mod)
plot(mixed_mod, type = "re")
get_model_data(mixed_mod, "lrt")
get_model_data(mixed_mod)
print_table(mixed_mod$GY$BLUPgen)
hist(mixed_mod$GY$BLUPgen)
hist(mixed_mod$Rust_adj$BLUPgen)
hist(mixed_mod$Rust_adj$BLUPgen$BLUPg)
##LOAD DATA##
library(readxl)
R18_19_20 <- read_excel("C:/Users/Salva/Desktop/DOCTORADO NUBE/ENSAYOS/GS/Genomic Selection_SALVA/data/R18_19_20.xlsx",
sheet = "R_all", col_types = c("text",
"text", "text", "text", "text", "text",
"numeric", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric"))
Rall <- data.frame(R18_19_20)
as_factor(Rall$ENV)
as_factor(Rall$REP)
as_factor(Rall$BLOCK)
as_factor(Rall$GEN)
##LOAD DATA##
library(readxl)
R18_19_20 <- read_excel("C:/Users/Salva/Desktop/DOCTORADO NUBE/ENSAYOS/GS/Genomic Selection_SALVA/data/R18_19_20.xlsx",
sheet = "R_all", col_types = c("text",
"text", "text", "text", "text", "text",
"numeric", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric"))
Rall <- data.frame(R18_19_20)
as_factor(Rall$ENV)
library(haven)
as_factor(Rall$ENV)
as_factor(Rall$REP)
as_factor(Rall$BLOCK)
as_factor(Rall$GEN)
library("metan")
mixed_mod <-
gamem_met(Rall,
env = ENV,
gen = GEN,
rep = REP,
block = BLOCK,
resp = "GDD_F",
random = "gen", #Default
verbose = TRUE)
plot(mixed_mod)
plot(mixed_mod, type = "re")
get_model_data(mixed_mod, "lrt")
get_model_data(mixed_mod)
mixed_mod <-
gamem_met(Rall,
env = ENV,
gen = GEN,
rep = REP,
block = BLOCK,
resp = "Biom_plant_g",
random = "gen", #Default
verbose = TRUE)
plot(mixed_mod)
plot(mixed_mod, type = "re")
get_model_data(mixed_mod, "lrt")
get_model_data(mixed_mod)
mixed_mod <-
gamem_met(Rall,
env = ENV,
gen = GEN,
rep = REP,
block = BLOCK,
resp = "Asco_adj",
random = "gen", #Default
verbose = TRUE)
plot(mixed_mod)
plot(mixed_mod, type = "re")
get_model_data(mixed_mod, "lrt")
get_model_data(mixed_mod)
mixed_mod <-
gamem_met(Rall,
env = ENV,
gen = GEN,
rep = REP,
block = BLOCK,
resp = "Rust_adj",
random = "gen", #Default
verbose = TRUE)
plot(mixed_mod)
plot(mixed_mod, type = "re")
get_model_data(mixed_mod, "lrt")
get_model_data(mixed_mod)
hist(mixed_mod$Rust_adj$BLUPgen$BLUPg)
knitr::opts_chunk$set(echo = TRUE)
library(metan)
library(readxl)
library(tidyverse)
library(metan)
library(readxl)
library(tidyverse)
R18 <- read_excel("~/GitHub/Genomic-Selection/Genomic Selection_SALVA/data/Ensayocampo2018.xlsx", sheet = "RawData", col_types =
c("text", #ENV
"text", #REP
"text", #BLOCK
"text", #ROW
"text", #GEN
"numeric", #GERM
"numeric", #BIOM
"numeric", #BIOM_PL
"numeric", #YIELD
"numeric", #YIELD_PL
"numeric", #BIOM/YIELD
"numeric", #Rust in %
"numeric", #Dtf
"numeric", #DtFP
"numeric", #DtP
"numeric", #Ascochyta in %
"numeric"  #Oidio in %
))
